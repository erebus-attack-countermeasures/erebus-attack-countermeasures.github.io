<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html lang="en">
<!--<![endif]-->

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">

    <title>Erebus's Countermeasures</title>

    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="css/stroke.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="css/animate.css">
    <link rel="stylesheet" type="text/css" href="css/prettyPhoto.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">

    <link rel="stylesheet" type="text/css" href="js/syntax-highlighter/styles/shCore.css" media="all">
    <link rel="stylesheet" type="text/css" href="js/syntax-highlighter/styles/shThemeRDark.css" media="all">

    <!-- CUSTOM -->
    <link rel="stylesheet" type="text/css" href="css/custom.css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>
    <button onclick="topFunction()" id="myBtn" title="Go to top"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>

    <script>
        var mybutton = document.getElementById("myBtn");
        window.onscroll = function() {scrollFunction()};
        function scrollFunction() {
            if (document.body.scrollTop > 1000 || document.documentElement.scrollTop > 1000) {
                mybutton.style.display = "block";
            } else {
                mybutton.style.display = "none";
            }
        }
        function topFunction() {
            window.scrollTo({ top: 0, behavior: 'smooth' })
            document.documentElement.scrollTo({ top: 0, behavior: 'smooth' })
        }

        document.addEventListener("DOMContentLoaded", () => {
            document.querySelector('#mode').addEventListener('click',()=>{
                document.querySelector('html').classList.toggle('dark');
            })
        });


    </script>

    <div id="wrapper">

        <div id="mode" >
            <div class="dark">
                <svg aria-hidden="true" viewBox="0 0 512 512">
                    <title>lightmode</title>
                    <path fill="currentColor" d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"></path>
                </svg>
            </div>
            <div class="light">
                <svg aria-hidden="true" viewBox="0 0 512 512">
                    <title>darkmode</title>
                    <path fill="currentColor" d="M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"></path>
                </svg>
            </div>
        </div>

        <div class="container">

            <section id="top" class="section docs-heading">

                <div class="row">
                    <div class="col-md-2">
                        <a href="#"><img src="images/logo.png" alt="" class="img-thumbnail"></a>
                    </div>
                    <div class="col-md-10">
                        <div class="big-title text-center">
                            <h1>Countermeasures against <a href="https://erebus-attack.comp.nus.edu.sg/">Erebus attacks</a></h1>
                            <p class="lead">Paper: "On the Routing-Aware Peering against Network-Eclipse Attacks in Bitcoin", <i>USENIX Security 2021</i></p>
                        </div>
                        <!-- end title -->
                    </div>
                    <!-- end 12 -->
                </div>
                <!-- end row -->

                <hr>

            </section>
            <!-- end section -->

            <div class="row">

                <div class="col-md-3">
                    <nav class="docs-sidebar" data-spy="affix" data-offset-top="300" data-offset-bottom="200" role="navigation">
                        <ul class="nav">
                            <li></li>
                            <li><a href="#">Home</a></li>
                            <li><a href="#overview">Overview</a></li>
                            <li><a href="#rap">Routing-Aware Peering (RAP)</a>
                                <ul class="nav">
                                    <li><a href="#rap_design">Design Overview</a></li>
                                    <li><a href="#rap_error">The Devil is in the detail: Inevitable inference errors</a></li>
                                    <li><a href="#rap_customization">Location-based customization</a></li>
                                </ul>
                            </li>
                            <li><a href="#results">Main Results</a></li>
                            
                            <li><a href="#faq">Frequently Asked Questions</a>
                                <ul class="nav">
                                    <li><a href="#faq_erebus">About Erebus attacks</a></li>
                                    <li><a href="#faq_rap">About RAP</a></li>
                                    <li><a href="#faq_tweak">About Bitcoin tweaks</a></li>
                                    <li><a href="#faq_other">Others</a></li>
                                </ul>
                            </li>
                            <li><a href="#people">People</a></li>
                        </ul>
                    </nav >
                </div>

                <div class="col-md-9">
                    <section class="welcome">
                        <div class="row">
                            <div class="col-md-5 left-align">
                                <h2 class="dark-text">TL;DR<hr></h2>
                            </div>
                            <!-- end col -->
                        </div>

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <div class="row">

                                    <div class="col-md-12 full">
                                        <div>
                                            <p>
                                                We critically analyze <b><i>Routing-Aware Peering (RAP)</i></b>, a desirable long-term solution to the Erebus attack that incorporates routing information to Bitcoin peer selection. <br>
                                                Unfortunately, we find that Erebus adversaries can still exploit a tiny portion of inevitable route inference errors in any RAP implementations to successfully eclipse Bitcoin nodes.<br>
                                                As a practical suggestion to Bitcoin, we propose an integrated defense framework that composes the available Bitcoin protocol tweaks and the optimal RAP implementation to prevent most Erebus attacks.
                                            </p>

                                            <a href="RAP-defense.pdf" class="btn btn-info">Download the paper</a> 
                                            <a href="RAP-defense.bib" class="btn btn-primary">Cite the paper</a>
                                            <hr>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    

                    <section id="overview" class="section">
                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Overview<hr></h2>
                            </div>
                            <!-- end col -->
                        </div>


                        <div class="row">
                            <div class="col-md-12 left-align">
                                <div class="row">

                                    <div class="col-md-12 full">
                                        <div>
                                            <p>
                                                The recent <a href="https://erebus-attack.comp.nus.edu.sg/">Erebus attack</a> shows that eclipse attacks with network-Sybil capability against Bitcoin's P2P network are possible. 
                                                <!-- In Erebus attacks, the network adversaries (e.g., large malicious ISPs) create millions Sybil peers by spoofing any IP addresses behind them in the routing view of a victim Bitcoin node. -->
                                                
                                                <!-- <br> -->
                                                <!-- <br> -->
                                                A few <a href="https://erebus-attack.comp.nus.edu.sg/#countermeasure">Bitcoin protocol tweaks</a> have been quickly implemented to counter the attacks; yet, they are not complete solutions.

                                                <br>
                                                <br>
                                                This work focuses on a more fundamental solution called <b><i>Routing-Aware Peering (RAP)</i></b>.
                                                RAP empowers individual Bitcoin nodes to analyze the routes towards their peers and detect Erebus adversaries, e.g., malicious Internet Service Providers (ISPs).
                                                <!-- We argue that preventing the Erebus attacks with RAP is only wishful thinking, unfortunately. -->
                                                <!-- <br> -->
                                                Unfortunately, we discover a <b><i>critical weakness</i></b> of RAP approaches, that is, their <b><i>infrequent yet inevitable</i></b> route inference errors.
                                                With such inference errors, Erebus adversaries can still create tens or even hundreds of thousands of Sybil peers and successfully eclipse victim Bitcoin nodes in many cases. 

                                                <br>
                                                <br>
                                                To that end, we propose an integrated defense framework that customizes the available simple protocol tweaks and RAP implementation for individual Bitcoin nodes to prevent most of Erebus attacks from the top-100 large ISPs.
                                            </p>

                                        </div>
                                    </div>

                                </div>
                                <!-- end row -->
                            </div>
                        </div>
                    </section>

                    <section id="rap" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Routing-Aware Peering (RAP)<hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="row">
                            <div class="col-md-6">
                                <img src="images/RAP-design.png" alt="" class="img-thumbnail">
                            </div>

                            <div class="col-md-6">
                                <h4 id="rap_design">Design overview</h4>
                                
                                <p>RAP adds a test before establishing new connections in Bitcoin.
                                 If an AS appears on the inferred route (AS-path) to the new IP as well as (some or all) routes to existing peers, this IP is rejected. 
                                 The threshold <b><i>T</i></b> (1 <= T <= 10) is an adjustable parameter controlling how strictly the RAP function is operated, i.e., the maximum number of allowed outgoing connections that go through an AS.
                                </p>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <hr>

                        <div class="row">
                            <div class="col-md-6">
                                <img src="images/misidentified-sybils.png" alt="" class="img-thumbnail">
                            </div>

                            <div class="col-md-6">
                                <h4 id="rap_error">The Devil is in the detail: Inevitable inference errors</h4>
                                <p>Any route inference approach may misidentify a Sybil peer as considering the route to it does not include the attacker.
                                The adversary can use such misidentified Sybil peers in an Erebus attack to circumvent RAP and eclipse a victim Bitcoin node.
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <hr>

                        <div class="row">
                            <div class="col-md-6">
                                <img src="images/RAP-customization.png" alt="" class="img-thumbnail">
                            </div>

                            <div class="col-md-6">
                                <h4 id="rap_customization">Location-based customization</h4>
                                <p>RAP must be customized for individual Bitcoin nodes based on their locations. 
                                    For example, nodes in well-connected ASes can enforce disjoint paths by setting low a threshold <b><i>T</i></b>.
                                    The optimal threshold is a minimum value that ensures all outgoing connections are established.
                                </p>
                            </div>
                        </div>

                    </section>

                    <section id="results" class="section">
                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Main Results<hr></h2>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <img src="images/RAP-evaluation.png" alt="" class="img-thumbnail">
                                <p> 
                                    Evaluation is done by emulating ~6,000 scenarios of different attacker-victim pairs. 
                                    See our <a href="https://github.com/Erebus-Attack/">extended emulation framework of the Bitcoin network stack</a> for more details.

                                </p>
                            </div>

                            <div class="col-md-6">
                                <h4 id="line2_3">Tweaks must be carefully combined</h4>
                                <p> We evaluate all possible tweak combinations from <i>03 new</i> and 03 existing tweaks to find the best combination that reduces the Erebus attack success rate to <b>20.86%</b>.
                                </p>
                                <h4 id="line2_3">RAP alone is insufficient</h4>
                                <p>RAP with optimal customizations reduces the attack success rate to <b>9.39%</b>.
                                    This insufficient defense performance is caused by Erebus attacks using misidentified Sybil peers.
                                </p>
                                <h4 id="line2_3">Combining RAP and tweaks</h4>
                                <p>Combining RAP and tweaks makes the most effective countermeasure against the Erebus attacks as the attack success rates drop to <b>3.17%</b>.
                                </p>
                            </div>
                        </div>

                    </section>
                    <!-- end section -->

                    <section id="faq" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Frequently Asked Questions<hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->
                        <div class="row">

                            <div class="col-md-12">
                                <h4 id="faq_erebus">About Erebus attacks</h4>
                                
                                <p>
                                    <b>[Q1] What is the Erebus attack?</b><br>

                                    Please refer to the main website of the <a href="https://erebus-attack.comp.nus.edu.sg/">Erebus attack</a> for more details.
                                </p>
                                <p>
                                    <b>[Q2] What countermeasures have been deployed against the Erebus attack?</b><br>
                                    As of this writing, three following Bitcoin protocol tweaks have been made to counter the Erebus attack: <br>
                                    (1) <a href="https://github.com/bitcoin/bitcoin/pull/16702">AS map</a>, <br>
                                    (2) <a href="https://github.com/bitcoin/bitcoin/pull/17428">anchor connections</a>, and<br>
                                    (3) <a href="https://github.com/bitcoin/bitcoin/pull/15759">two more outgoing connections</a>.
                                </p>
                                <p>
                                    <b>[Q3] Is there any real-world instance of Erebus attack yet?</b><br>
                                    We still haven't heard any reports about Erebus attacks on Bitcoin.
                                    However, last years have seen Eclipse attacks against other cryptocurrencies, such as <a href="https://sethsimmons.me/posts/moneros-ongoing-network-attack/">Monero</a>.
                                </p>
                            </div>
                        </div>

                        <div class="row">

                            <div class="col-md-12">
                                <h4 id="faq_rap">About RAP</h4>
                                
                                <p>
                                    <b>[Q4] Why is RAP believed to prevent the Erebus attack?</b><br>
                                    Because RAP provides each Bitcoin node with a defense capability that is symmetric to Erebus adversaries (i.e., end-to-end routing knowledge).
                                    Moreover, the idea of RAP has been already shown to be highly effective in securing Tor against network-based privacy attacks.
                                </p>

                                <p>
                                    <b>[Q5] Why is there always inference error in RAP?</b><br>
                                    The only way to get the accurate route is via data-plane active measurements (e.g., using <i>traceroute</i>), which cannot be used in practice because the measurement packets traverse through the adversary network and can be easily manipulated.<br>
                                    The available options include local route estimation and querying the routing table of the home network. Both methods return the control-plane routes, which cannot be the same as the data-plane routes, hence the inevitable inference errors.
                                </p>

                                <p>
                                    <b>[Q6] How does an adversary find the misidentified Sybil peers?</b><br>
                                    The adversary can send a spoofed packet (e.g., TCP SYN) with a source address <i>p</i> to the victim. 
                                    If the adversary observes a reply packet (e.g., TCP SYN/ACK), <i>p</i> can be used as a Sybil peer. 
                                    Then <i>p</i> is tested with RAP's route inference to see if RAP misidentifies it.
                                </p>

                                <p>
                                    <b>[Q7] Why does RAP work in Tor but not in Bitcoin?</b><br>
                                    Tor is not a fully permissionless system like Bitcoin as new relays must have their bandwidth reviewed before joining. 
                                    Hence, network attackers cannot attack Tor even when RAP in Tor misidentifies large numbers of Sybil identities.
                                </p>
                                
                                <p>
                                    <b>[Q8] Are there any performance overhead?</b><br>
                                    To enable RAP, Bitcoin nodes may need to pre-compute the routes to other IP addresses locally or query the home network for them regularly (e.g., every month). 
                                    Besides that, the performance overhead for establishing new connections is negligible.
                                </p>

                                <p>
                                    <b>[Q9] Does RAP only apply to Bitcoin?</b><br>
                                    RAP is not Bitcoin-specific and can be applied to the peer establishment of any other cryptocurrencies.
                                </p>

                                <p>
                                    <b>[Q10] What are the differences between RAP and existing quick defenses (e.g., relays, Tor, VPNs)?</b><br>
                                    RAP does not hurt the openness and decentralization of Bitcoin.
                                </p>

                            </div>
                            
                        </div>

                        <div class="row">

                            <div class="col-md-12">
                                <h4 id="faq_tweak">About Bitcoin tweaks</h4>
                                
                                <p>
                                    <b>[Q11] How are Bitcoin tweaks systematically found?</b><br>
                                    We list all possible steps of the <i>life-cycle</i> of an IP address in the internal data structure of Bitcoin.
                                    By doing so, we find 03 new protocol tweaks in addition to the existing ones.
                                </p>

                                <p>
                                    <b>[Q12] Why don't we simply combine all possible tweaks?</b><br>
                                    Because the efficacy of these countermeasures is <i>non-monotonic</i> --- activating more countermeasures does not necessarily guarantee higher defense performance in terms of attack success rate. Thus, we need to evaluate many combinations and select a proper set of countermeasures.
                                </p>

                                <p>
                                    <b>[Q13] Is there a performance evaluation of individual tweaks?</b><br>
                                    Yes, please refer to <a href="rap-defense.pdf">our paper</a>.
                                </p>

                                <p>
                                    <b>[Q14] Can similar tweaks work for other cryptocurrencies?</b><br>
                                    Yes if the other cryptocurrency has a similar P2P code as Bitcoin, see a <a href="https://erebus-attack.comp.nus.edu.sg/#qa">few examples</a> on the Erebus attack website. 
                                    They can also potentially be applied to other cryptocurrencies that have similar peer management data structures at a high-level, such as Etherum and Monero.
                                </p>
                            </div>
                            
                        </div>

                        <div class="row">

                            <div class="col-md-12">
                                <h4 id="faq_other">Others</h4>
                                
                                <p>
                                    <b>[Q15] What to do if I am running a Bitcoin node?</b><br>
                                    You should wait for Bitcoin Core updates, as RAP and other protocol tweaks are being considered by Bitcoin Core developers.
                                </p>

                                <p>
                                    <b>[Q16] Should I consider multi-homed ISPs to host my Bitcoin node?</b><br>
                                    Yes, it helps to reduce the risk of naturally having a common ISP on your connections and when RAP is deployed.
                                    However, it does not help if a malicious large ISP actively launching Erebus attacks against your node.
                                </p>
                            </div>
                            
                        </div>

                    </section>
                    <!-- end section -->

                    <section id="people" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">People<hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="row">

                            <div class="col-md-4">
                                <a href="https://www.comp.nus.edu.sg/~muoitran/"><img src="images/muoitran.jpg" alt="" class="img-responsive img-thumbnail"></a>
                                <a href="https://www.comp.nus.edu.sg/~muoitran/"><h4 id="line5_1"><u>Muoi Tran</u></h4></a>
                                <ul>
                                    <li><strong>National University of Singapore</strong></li>
                                    <li><a href="mailto:muoitran@comp.nus.edu.sg">muoitran@comp.nus.edu.sg</a></li>
                                </ul>
                            </div>
                            <!-- end col -->

                            <div class="col-md-4">
                                <a href="https://github.com/akshayeshenoi"><img src="images/akshaye.jpeg" alt="" class="img-responsive img-thumbnail"></a>
                                <a href="https://github.com/akshayeshenoi"><h4 id="line5_2"><u>Akshaye Shenoi</u></h4></a>
                                <ul>
                                    <li><strong>National University of Singapore</strong></li>
                                    <li><a href="mailto:akshaye@comp.nus.edu.sg">akshaye@comp.nus.edu.sg</a></li>
                                </ul>
                            </div>
                            <!-- end col -->

                            <div class="col-md-4">
                                <a href="https://netsp.kaist.ac.kr/min-suk-kang"><img src="images/minsuk.jpg" alt="" class="img-responsive img-thumbnail"></a>
                                <a href="https://netsp.kaist.ac.kr/min-suk-kang"><h4 id="line5_3"><u>Min Suk Kang</u></h4></a>
                                <ul>
                                    <li><strong>KAIST</strong></li>
                                    <li><a href="mailto:minsukk@kaist.ac.kr">minsukk@kaist.ac.kr</a></li>
                                </ul>
                            </div>
                            <!-- end col -->
                            <hr>

                        </div>
                        <!-- end row -->

                    </section>
                    <!-- end section -->
                    <div class="col-md-12">
                        <p> &copy; <a href="https://www.comp.nus.edu.sg/~muoitran/">Muoi Tran</a>. Design: <a href="https://github.com/surjithctly/documentation-html-template">Surjith S M</a>. Last update on March 1, 2021.
                        </p>
                    
                    </div>

                </div>
                <!-- // end .col -->

            </div>
            <!-- // end .row -->

        </div>
        <!-- // end container -->

    </div>
    <!-- end wrapper -->

    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/retina.js"></script>
    <script src="js/jquery.fitvids.js"></script>
    <script src="js/wow.js"></script>
    <script src="js/jquery.prettyPhoto.js"></script>

    <!-- CUSTOM PLUGINS -->
    <script src="js/custom.js"></script>
    <script src="js/main.js"></script>

    <script src="js/syntax-highlighter/scripts/shCore.js"></script>
    <script src="js/syntax-highlighter/scripts/shBrushXml.js"></script>
    <script src="js/syntax-highlighter/scripts/shBrushCss.js"></script>
    <script src="js/syntax-highlighter/scripts/shBrushJScript.js"></script>

</body>

</html>
